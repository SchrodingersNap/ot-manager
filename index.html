This is a crucial feature. Everyone makes mistakes (misclicks)!

I have updated the code to **Version 14**.

### üõ†Ô∏è New Feature: "Correction Mode"

In the **Database** tab, you will now see an **‚úèÔ∏è Edit** button next to every person.

**How to fix a mistake:**

1. Go to the **"Database"** tab.
2. Search for the person's name.
3. Click **‚úèÔ∏è Edit**.
4. A box will pop up asking for the **Correct OT Hours**.
5. Enter the right number and click OK. The system instantly updates and re-shuffles the ranking.

### ‚úàÔ∏è IOCL OT Manager (V14: with Error Correction)

Save this as `index.html`.

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IOCL OT Manager (V14)</title>
    <style>
        :root { --primary: #0056b3; --bg: #f4f7f6; --text: #333; --card: #fff; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); padding: 15px; max-width: 950px; margin: 0 auto; }
        
        /* Header */
        header { text-align: center; margin-bottom: 20px; }
        h1 { margin: 0; color: var(--primary); }
        .subtitle { color: #666; font-size: 0.9em; }

        /* Tabs */
        .tabs { display: flex; gap: 10px; margin-bottom: 15px; overflow-x: auto; }
        .tab-btn { padding: 10px 20px; border: none; background: #e0e0e0; border-radius: 20px; cursor: pointer; font-weight: 600; white-space: nowrap; }
        .tab-btn.active { background: var(--primary); color: white; }

        /* Content Cards */
        .card { background: var(--card); padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 20px; display: none; }
        .card.active { display: block; }
        
        /* Grid Layout */
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        
        /* Inputs */
        label { display: block; font-size: 0.85em; font-weight: bold; margin-bottom: 5px; color: #555; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 1em; }
        textarea { height: 120px; font-family: monospace; }
        
        /* Buttons */
        button { width: 100%; padding: 14px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px; font-size: 1em; transition: 0.2s; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-sec { background: #6c757d; color: white; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-sm { width: auto; padding: 6px 12px; font-size: 0.85em; margin: 0; }
        .btn-edit { background: #ff9800; color: white; width: auto; padding: 5px 10px; font-size: 0.8em; }

        /* Tables */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.9em; }
        th { text-align: left; padding: 10px; background: #f8f9fa; color: #666; border-bottom: 2px solid #ddd; }
        td { padding: 10px; border-bottom: 1px solid #eee; vertical-align: middle; }
        
        /* Row Styles */
        .row-absent { background-color: #ffebee; color: #b71c1c; opacity: 0.7; }
        .row-dc { background-color: #fff3e0; color: #e65100; opacity: 0.7; }
        .row-extra { background-color: #e8f5e9; border-left: 5px solid #4caf50; }

        /* Status & Badges */
        .status-A { color: red; font-weight: 900; font-size: 1.2em; }
        .status-DC { color: #e65100; font-weight: 900; font-size: 1.1em; }
        .status-Rank { color: #0056b3; font-weight: bold; font-size: 1.1em; }
        
        .badge { display: inline-block; padding: 2px 6px; border-radius: 6px; font-size: 0.75em; font-weight: 700; margin-right: 5px; }
        .badge-dr { background: #e3f2fd; color: #1565c0; border: 1px solid #bbdefb; } 
        .badge-nd { background: #f5f5f5; color: #616161; border: 1px solid #e0e0e0; }

        /* Notifications */
        #statusMsg { position: fixed; bottom: 20px; right: 20px; background: #333; color: white; padding: 12px 20px; border-radius: 8px; display: none; z-index: 100; }
        #unmatchedList { background: #fff5f5; color: #c62828; padding: 10px; border-radius: 8px; margin-top: 10px; display: none; font-size: 0.9em; }
    </style>
</head>
<body>

    <header>
        <h1>‚úàÔ∏è IOCL OT Manager V14</h1>
        <div class="subtitle">Manual Correction Mode Enabled</div>
    </header>

    <div class="tabs">
        <button class="tab-btn active" onclick="showTab('daily')">Daily Operation</button>
        <button class="tab-btn" onclick="showTab('roster')">Database (Edit/Correct)</button>
        <button class="tab-btn" onclick="showTab('setup')">Import Sequence</button>
    </div>

    <div id="daily" class="card active">
        <div class="grid-2">
            <div>
                <label>Groups on Duty (e.g. 1 7)</label>
                <input type="text" id="dutyInput" placeholder="Enter group numbers">
            </div>
            <div>
                <label>OT Next Shift (Hrs)</label>
                <select id="shiftInput">
                    <option value="A">Shift A (+6 hrs)</option>
                    <option value="B">Shift B (+8 hrs)</option>
                    <option value="C">Shift C (+10 hrs)</option>
                </select>
            </div>
        </div>
        
        <div class="grid-2" style="margin-top: 15px;">
            <div>
                <label>Absentees</label>
                <input type="text" id="absentInput" placeholder="Search name...">
            </div>
            <div>
                <label>Duty Swap: [Worker] for [Original]</label>
                <div style="display:flex; gap:5px;">
                    <input type="text" id="swapReplacer" placeholder="Worker">
                    <input type="text" id="swapOriginal" placeholder="Original">
                </div>
            </div>
        </div>

        <button class="btn-primary" onclick="generateList()">üîÑ Generate Priority List</button>

        <div id="resultSection" style="display:none; margin-top:20px; border-top:2px solid #eee; padding-top:10px;">
            
            <h3 style="margin:0 0 10px 0;">Priority Sequence</h3>
            <table>
                <thead>
                    <tr>
                        <th style="width:40px">Rank</th>
                        <th>Name</th>
                        <th>Role</th>
                        <th>Grp</th>
                        <th>Hrs</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="mainListBody"></tbody>
            </table>

            <h4 style="margin: 20px 0 10px 0; color: #2e7d32;">‚¨áÔ∏è Duty Swap / Replacers</h4>
            <table>
                <thead>
                    <tr>
                        <th style="width:40px">Type</th>
                        <th>Name</th>
                        <th>Role</th>
                        <th>Grp</th>
                        <th>Hrs</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="extraListBody"></tbody>
            </table>

        </div>
    </div>

    <div id="roster" class="card">
        <h3>Staff Database & Corrections</h3>
        <p style="color:#666; font-size:0.8em;">Made a mistake? Click "Edit" to fix hours manually.</p>
        <input type="text" id="dbSearch" placeholder="Search Name..." onkeyup="renderDB()">
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Role</th>
                    <th>Grp</th>
                    <th>Hrs</th>
                    <th>Fix</th>
                </tr>
            </thead>
            <tbody id="dbBody"></tbody>
        </table>
    </div>

    <div id="setup" class="card">
        <h3>1. Import Base Sequence</h3>
        <p style="color:#666; font-size:0.9em;">Paste Excel (Name + Rank). Resets Hours to 0.</p>
        <textarea id="excelInput" placeholder="Example:&#10;Tej Singh Meena   1&#10;Rajendra Kumar    2"></textarea>
        <button class="btn-sec" onclick="processBaseSequence()">Import & Reset</button>
        <div id="unmatchedList"></div>
        <button class="btn-danger" onclick="hardReset()" style="margin-top: 30px;">‚ö†Ô∏è Factory Reset</button>
    </div>

    <div id="statusMsg"></div>

<script>
    const HOURS = { 'A': 6, 'B': 8, 'C': 10 };
    
    // DB Map
    const dbMap = [
        { name: "Bidhan Deb Barma", group: 1, role: "Dr" }, { name: "Sanjay Paul", group: 1, role: "Dr" },
        { name: "Gourab Biswas", group: 1, role: "Dr" }, { name: "Pardeep .", group: 1, role: "Dr" },
        { name: "Mrityunjoy Saha", group: 1, role: "ND" }, { name: "Pradip Kumar Mondal", group: 1, role: "ND" },
        { name: "Pramod Kumar Meena", group: 1, role: "ND" }, { name: "Sunit Kumar Das", group: 1, role: "ND" },
        { name: "Pankaj Chowdhury", group: 2, role: "Dr" }, { name: "PARTHA ROY", group: 2, role: "Dr" },
        { name: "Mukesh Swami", group: 2, role: "Dr" }, { name: "Joydeb Mandal", group: 2, role: "Dr" },
        { name: "Abhisake Chandan Tirkey", group: 2, role: "ND" }, { name: "Kingsuk Burman", group: 2, role: "ND" },
        { name: "Shibendu Dutta", group: 2, role: "ND" }, { name: "Rajib Kumar Paul", group: 2, role: "ND" },
        { name: "Rajendra Kumar", group: 3, role: "Dr" }, { name: "Amit Kumar", group: 3, role: "Dr" },
        { name: "VARASALA AMBEDKAR", group: 3, role: "Dr" }, { name: "Vikas Chhikara", group: 3, role: "Dr" },
        { name: "DIPANKAR DEY", group: 3, role: "Dr" }, { name: "Sanjib Kumar Mondal", group: 3, role: "ND" },
        { name: "Sukumar Maji", group: 3, role: "ND" }, { name: "Alok Roy", group: 3, role: "ND" },
        { name: "Pradip Karmakar", group: 3, role: "ND" },
        { name: "Mohit", group: 4, role: "Dr" }, { name: "Jitender .", group: 4, role: "Dr" },
        { name: "Subhra Jyoti Banerjee", group: 4, role: "Dr" }, { name: "Tej Singh Meena", group: 4, role: "Dr" },
        { name: "Sarbeswar Hembram", group: 4, role: "ND" }, { name: "RAJIB SEN", group: 4, role: "ND" },
        { name: "Gopal Howli", group: 4, role: "ND" }, { name: "Kalyan Mondal", group: 4, role: "ND" },
        { name: "Chandra Nath Mitra", group: 5, role: "Dr" }, { name: "Sudhir .", group: 5, role: "Dr" },
        { name: "Manjeet .", group: 5, role: "Dr" }, { name: "Somenath Mandal", group: 5, role: "Dr" },
        { name: "BISWARUP CHAKRABORTY", group: 5, role: "ND" }, { name: "Ashok Dasgupta", group: 5, role: "ND" },
        { name: "Sanjay Dey", group: 5, role: "ND" }, { name: "Sanjit Mondal", group: 5, role: "ND" },
        { name: "Subhajit Saha", group: 6, role: "Dr" }, { name: "Soumen Mondal", group: 6, role: "Dr" },
        { name: "Naveen .", group: 6, role: "Dr" }, { name: "Shyamal Kumar Ghosh", group: 6, role: "ND" },
        { name: "Dhirendar Kumar", group: 6, role: "ND" }, { name: "Soumalaya", group: 6, role: "ND" },
        { name: "Azam Ali", group: 7, role: "Dr" }, { name: "Nitin Kumar", group: 7, role: "Dr" },
        { name: "Anil Kumar", group: 7, role: "Dr" }, { name: "Goutam Patra", group: 7, role: "Dr" },
        { name: "PALLAB KR. SAHA", group: 7, role: "ND" }, { name: "SK. SABIR AHMED", group: 7, role: "ND" },
        { name: "SOMENATH DAS", group: 7, role: "ND" }, { name: "Hemlal Sharma", group: 7, role: "ND" }
    ];

    let roster = [];

    window.onload = () => {
        // v14 Key
        const saved = localStorage.getItem('iocl_v14_data');
        if (saved) {
            roster = JSON.parse(saved);
        } else {
            roster = dbMap.map((p, i) => ({ ...p, current: 0, baseRank: i, lastWorked: 0 }));
            save();
        }
        renderDB();
    };

    function save() {
        localStorage.setItem('iocl_v14_data', JSON.stringify(roster));
        renderDB();
    }

    // === EDIT FUNCTION (Fix Mistakes) ===
    function manualEdit(index) {
        const p = roster[index];
        const newHrs = prompt(`Edit Hours for ${p.name}\nCurrent: ${p.current}`, p.current);
        
        if (newHrs !== null && !isNaN(newHrs)) {
            p.current = parseFloat(newHrs);
            // Optionally ask for Rank correction too?
            // For simplicity, we assume if you fix hours, sequence auto-fixes on next generation
            save();
            showMsg("Corrected! Value Saved.");
        }
    }

    // === GENERATE LIST ===
    function generateList() {
        const groups = document.getElementById('dutyInput').value.split(/[\s,]+/).map(Number).filter(n => n > 0);
        const shift = document.getElementById('shiftInput').value;
        const absentees = document.getElementById('absentInput').value.toLowerCase().split(',').filter(s => s.trim());
        const repName = document.getElementById('swapReplacer').value;
        const orgName = document.getElementById('swapOriginal').value;

        let absentIdx = [];
        absentees.forEach(a => {
            const p = findPerson(a);
            if(p) absentIdx.push(p.index);
        });

        let originalIdx = -1;
        if (orgName) {
            const org = findPerson(orgName);
            if (org) originalIdx = org.index;
        }

        let replacerIdx = -1;
        if (repName) {
            const rep = findPerson(repName);
            if (rep) replacerIdx = rep.index;
        }

        let mainList = [];
        let extraList = [];

        if (replacerIdx !== -1) {
            extraList.push({ ...roster[replacerIdx], idx: replacerIdx });
        }

        roster.forEach((p, index) => {
            if (index === replacerIdx) return; 

            if (groups.includes(p.group)) {
                let status = 'Normal';
                if (absentIdx.includes(index)) status = 'A';
                else if (index === originalIdx) status = 'DC';
                
                mainList.push({ ...p, idx: index, status: status });
            }
        });

        mainList.sort((a, b) => {
            if (a.current !== b.current) return a.current - b.current;
            if (a.lastWorked !== b.lastWorked) return a.lastWorked - b.lastWorked;
            return a.baseRank - b.baseRank;
        });

        renderTables(mainList, extraList, shift);
    }

    function renderTables(mainList, extraList, shift) {
        const mainBody = document.getElementById('mainListBody');
        const extraBody = document.getElementById('extraListBody');
        mainBody.innerHTML = '';
        extraBody.innerHTML = '';
        
        document.getElementById('resultSection').style.display = 'block';
        const add = HOURS[shift];
        const getBadge = (role) => role === 'Dr' ? `<span class="badge badge-dr">Driver</span>` : `<span class="badge badge-nd">Non-Dr</span>`;

        let rankCounter = 1;
        mainList.forEach(p => {
            const tr = document.createElement('tr');
            let rankHtml = '';
            let rowClass = '';

            if (p.status === 'A') {
                rankHtml = '<span class="status-A">A</span>';
                rowClass = 'row-absent';
            } else if (p.status === 'DC') {
                rankHtml = '<span class="status-DC">DC</span>';
                rowClass = 'row-dc';
            } else {
                rankHtml = `<span class="status-Rank">${rankCounter++}</span>`;
            }

            tr.className = rowClass;
            tr.innerHTML = `
                <td>${rankHtml}</td>
                <td>${p.name}</td>
                <td>${getBadge(p.role)}</td>
                <td>${p.group}</td>
                <td>${p.current}</td>
                <td>
                    <button class="btn-primary btn-sm" onclick="update(${p.idx}, ${add}, false)">Work</button>
                    <button class="btn-danger btn-sm" onclick="update(${p.idx}, ${add}, true)">Refuse</button>
                </td>
            `;
            mainBody.appendChild(tr);
        });

        extraList.forEach(p => {
            const tr = document.createElement('tr');
            tr.className = 'row-extra';
            tr.innerHTML = `
                <td><span style="font-weight:bold; color:green;">SWAP</span></td>
                <td>${p.name}</td>
                <td>${getBadge(p.role)}</td>
                <td>${p.group}</td>
                <td>${p.current}</td>
                <td>
                    <button class="btn-primary btn-sm" onclick="update(${p.idx}, ${add}, false)">Work</button>
                    <button class="btn-danger btn-sm" onclick="update(${p.idx}, ${add}, true)">Refuse</button>
                </td>
            `;
            extraBody.appendChild(tr);
        });

        if(extraList.length === 0) extraBody.innerHTML = '<tr><td colspan="6" style="text-align:center; color:#999;">No duty swaps.</td></tr>';
    }

    function update(index, amount, isRefusal) {
        if (!confirm(`Update ${roster[index].name}?`)) return;
        roster[index].current += amount;
        roster[index].lastWorked = Date.now();
        
        let tempRoster = [...roster].map((p, i) => ({ ...p, originalIdx: i }));
        tempRoster.sort((a, b) => {
            if (a.current !== b.current) return a.current - b.current;
            if (a.lastWorked !== b.lastWorked) return a.lastWorked - b.lastWorked;
            return a.baseRank - b.baseRank;
        });
        tempRoster.forEach((p, newRank) => {
            roster[p.originalIdx].baseRank = newRank;
        });

        save();
        generateList();
        showMsg("Updated!");
    }

    // === UTILS ===
    function processBaseSequence() {
        const lines = document.getElementById('excelInput').value.split('\n');
        let count = 0;
        roster.forEach(p => { p.current = 0; p.lastWorked = 0; p.baseRank = 999; });

        lines.forEach(line => {
            const parts = line.trim().split(/\t/);
            if (parts.length >= 2) {
                const name = parts[0].trim();
                const rank = parseInt(parts[1]);
                if (!isNaN(rank)) {
                    const match = findPerson(name);
                    if (match) {
                        roster[match.index].baseRank = rank;
                        count++;
                    }
                }
            }
        });
        save();
        alert(`Import Complete!\n- ${count} sequences set.`);
    }

    function hardReset() {
        if (confirm("DELETE ALL DATA?")) {
            localStorage.removeItem('iocl_v14_data');
            location.reload();
        }
    }

    function findPerson(query) {
        query = query.toLowerCase().trim().replace(/\s+/g, ' ');
        let idx = roster.findIndex(p => p.name.toLowerCase() === query);
        if (idx !== -1) return { index: idx, ...roster[idx] };
        if (query.length > 3) {
            idx = roster.findIndex(p => p.name.toLowerCase().includes(query));
            if (idx !== -1) return { index: idx, ...roster[idx] };
        }
        return null;
    }

    function showTab(id) {
        document.querySelectorAll('.card').forEach(c => c.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');
    }

    function renderDB() {
        const tbody = document.getElementById('dbBody');
        tbody.innerHTML = '';
        const search = document.getElementById('dbSearch').value.toLowerCase();
        
        roster.forEach((p, i) => {
            if (search && !p.name.toLowerCase().includes(search)) return;
            const tr = document.createElement('tr');
            
            const badge = p.role === 'Dr' 
                ? `<span class="badge badge-dr">Dr</span>` 
                : `<span class="badge badge-nd">ND</span>`;

            tr.innerHTML = `
                <td>${p.name}</td>
                <td>${badge}</td>
                <td>${p.group}</td>
                <td>${p.current}</td>
                <td>
                    <button class="btn-edit" onclick="manualEdit(${i})">‚úèÔ∏è Edit</button>
                </td>
            `;
            tbody.appendChild(tr);
        });
    }

    function showMsg(txt) {
        const el = document.getElementById('statusMsg');
        el.innerText = txt;
        el.style.display = 'block';
        setTimeout(() => el.style.display = 'none', 3000);
    }
</script>
</body>
</html>

```
